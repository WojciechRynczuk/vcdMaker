<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
  <Product Name='vcdMaker 1.0' Id='0E0B8006-8388-4DC6-B2A2-1EA0E6A954B7' UpgradeCode='3A563016-E31D-4D93-A36B-105420BA6E57'
    Language='1033' Codepage='1252' Version='1.0.1' Manufacturer='Wojciech Rynczuk'>

    <Package Id='*' Keywords='vcdMaker Installer'
      Description="vcdMaker 1.0 Installer"
      Comments='vcdMaker Package' Manufacturer='Wojciech Rynczuk'
      InstallerVersion='200' Languages='1033' Compressed='yes' SummaryCodepage='1252' />
    
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Media Id='1' Cabinet='Install.cab' EmbedCab='yes' DiskPrompt="CD-ROM #1" />
    <Property Id='DiskPrompt' Value="vcdMaker 1.0 Installation [1]" />

    <Directory Id='TARGETDIR' Name='SourceDir'>
      <Directory Id='ProgramFilesFolder' Name='PFiles'>
        <Directory Id='INSTALLDIR' Name='vcdMaker'>

          <Component Id='vcdMakerExecutable' Guid='CF176F63-6DA4-45A6-837B-CD1AFF3F5C12'>
            <Environment Id='UpdatePath' Name='PATH' Action='set' Permanent='no' System='no' Part='last' Value='[INSTALLDIR]' />
            <File Id='vcdMakerEXE' Name='$(var.vcdMaker.TargetFileName)' DiskId='1' Source='$(var.vcdMaker.TargetPath)' KeyPath='yes'>
            </File>
          </Component>

          <Component Id='vcdMakerManual' Guid='82B593FF-F018-4D28-87F3-A253FE5D4F7D'>
            <File Id="ManualPdf" Name="Manual.pdf" Source="$(var.SolutionDir)..\..\sources\doc\manual.pdf" KeyPath='yes'>
              <Shortcut Id="vcdMakerManual.ico" Directory="ProgramMenuDir" Name="vcdMaker 1.0 Manual" WorkingDirectory='INSTALLDIR' Icon="IconPdf.ico" IconIndex="0" Advertise="yes" />
            </File>
          </Component>
          
          <Directory Id='SampleDir' Name='samples'>
            <Component Id='SampleFiles' Guid='C87B5829-C991-4527-9D16-3507C907395F'>
              <File Id="SampleTtx" Name="example.txt" Source="$(var.SolutionDir)..\..\sources\doc\examples\example.txt" KeyPath='yes'></File>
              <File Id="SampleVcd" Name="example.vcd" Source="$(var.SolutionDir)..\..\sources\doc\examples\example.vcd"></File>
            </Component>
          </Directory>
        
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Directory Id="ProgramMenuDir" Name="vcdMaker 1.0">
          <Component Id="ProgramMenuDir" Guid="FE343CAE-C7B4-47DF-B133-FAAC5F90F2DF">
            <RemoveFolder Id='ProgramMenuDir' On='uninstall' />
            <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Type='string' Value='' KeyPath='yes' />
          </Component>
        </Directory>
      </Directory>

    <Directory Id="DesktopFolder" Name="Desktop" />
    </Directory>

    <Feature Id='MainProgram' Title='vcdMaker 1.0' Description='The vcdMaker package.' Level='1'>
      <ComponentRef Id='vcdMakerExecutable' />
      <ComponentRef Id='vcdMakerManual' />
      <ComponentRef Id='SampleFiles' />
      <ComponentRef Id='ProgramMenuDir' />
    </Feature>

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />
    <UIRef Id="WixUI_InstallDir" />
    
    <WixVariable Id="WixUILicenseRtf" Value="$(var.SolutionDir)\resources\license.rtf" />

    <Icon Id="IconPdf.ico" SourceFile="$(var.SolutionDir)\resources\pdf.ico" />

  </Product>
</Wix>
